############################################################################
#  Mesh file for viscoplastic bar in tension
#
#  Notched bar geometry to demonstrate rate-dependent plastic behavior
#  The notch creates stress concentration where plastic flow initiates
############################################################################

<Nodes>
  1   0.0  0.0  0.0;
  2   0.5  0.0  0.0;
  3   1.0  0.0  0.0;
  4   1.5  0.0  0.0;
  5   2.0  0.0  0.0;
  6   2.5  0.0  0.0;
  7   3.0  0.0  0.0;
  8   3.5  0.05 0.0;
  9   4.0  0.05 0.0;
 10   4.5  0.0  0.0;
 11   5.0  0.0  0.0;
 12   5.5  0.0  0.0;
 13   6.0  0.0  0.0;
 14   6.5  0.0  0.0;
 15   7.0  0.0  0.0;
 16   7.5  0.0  0.0;
 17   8.0  0.0  0.0;

 21   0.0  0.5  0.0;
 22   0.5  0.5  0.0;
 23   1.0  0.5  0.0;
 24   1.5  0.5  0.0;
 25   2.0  0.5  0.0;
 26   2.5  0.5  0.0;
 27   3.0  0.5  0.0;
 28   3.5  0.45 0.0;
 29   4.0  0.45 0.0;
 30   4.5  0.5  0.0;
 31   5.0  0.5  0.0;
 32   5.5  0.5  0.0;
 33   6.0  0.5  0.0;
 34   6.5  0.5  0.0;
 35   7.0  0.5  0.0;
 36   7.5  0.5  0.0;
 37   8.0  0.5  0.0;

 41   0.0  0.0  0.2;
 42   0.5  0.0  0.2;
 43   1.0  0.0  0.2;
 44   1.5  0.0  0.2;
 45   2.0  0.0  0.2;
 46   2.5  0.0  0.2;
 47   3.0  0.0  0.2;
 48   3.5  0.05 0.2;
 49   4.0  0.05 0.2;
 50   4.5  0.0  0.2;
 51   5.0  0.0  0.2;
 52   5.5  0.0  0.2;
 53   6.0  0.0  0.2;
 54   6.5  0.0  0.2;
 55   7.0  0.0  0.2;
 56   7.5  0.0  0.2;
 57   8.0  0.0  0.2;

 61   0.0  0.5  0.2;
 62   0.5  0.5  0.2;
 63   1.0  0.5  0.2;
 64   1.5  0.5  0.2;
 65   2.0  0.5  0.2;
 66   2.5  0.5  0.2;
 67   3.0  0.5  0.2;
 68   3.5  0.45 0.2;
 69   4.0  0.45 0.2;
 70   4.5  0.5  0.2;
 71   5.0  0.5  0.2;
 72   5.5  0.5  0.2;
 73   6.0  0.5  0.2;
 74   6.5  0.5  0.2;
 75   7.0  0.5  0.2;
 76   7.5  0.5  0.2;
 77   8.0  0.5  0.2;
</Nodes>

<Elements>
  1  "Continuum"  1  2 22 21 41 42 62 61;
  2  "Continuum"  2  3 23 22 42 43 63 62;
  3  "Continuum"  3  4 24 23 43 44 64 63;
  4  "Continuum"  4  5 25 24 44 45 65 64;
  5  "Continuum"  5  6 26 25 45 46 66 65;
  6  "Continuum"  6  7 27 26 46 47 67 66;
  7  "Continuum"  7  8 28 27 47 48 68 67;
  8  "Continuum"  8  9 29 28 48 49 69 68;
  9  "Continuum"  9 10 30 29 49 50 70 69;
 10  "Continuum" 10 11 31 30 50 51 71 70;
 11  "Continuum" 11 12 32 31 51 52 72 71;
 12  "Continuum" 12 13 33 32 52 53 73 72;
 13  "Continuum" 13 14 34 33 53 54 74 73;
 14  "Continuum" 14 15 35 34 54 55 75 74;
 15  "Continuum" 15 16 36 35 55 56 76 75;
 16  "Continuum" 16 17 37 36 56 57 77 76;
</Elements>

<NodeConstraints>
  # Fix left end
  u[1]  = 0.0;
  u[21] = 0.0;
  u[41] = 0.0;
  u[61] = 0.0;
  
  # Symmetry constraints
  v[1]  = 0.0;
  v[2]  = 0.0;
  v[3]  = 0.0;
  v[4]  = 0.0;
  v[5]  = 0.0;
  v[6]  = 0.0;
  v[7]  = 0.0;
  v[8]  = 0.0;
  v[9]  = 0.0;
  v[10] = 0.0;
  v[11] = 0.0;
  v[12] = 0.0;
  v[13] = 0.0;
  v[14] = 0.0;
  v[15] = 0.0;
  v[16] = 0.0;
  v[17] = 0.0;
  
  w[1]  = 0.0;
  w[2]  = 0.0;
  w[3]  = 0.0;
  w[4]  = 0.0;
  w[5]  = 0.0;
  w[6]  = 0.0;
  w[7]  = 0.0;
  w[8]  = 0.0;
  w[9]  = 0.0;
  w[10] = 0.0;
  w[11] = 0.0;
  w[12] = 0.0;
  w[13] = 0.0;
  w[14] = 0.0;
  w[15] = 0.0;
  w[16] = 0.0;
  w[17] = 0.0;
</NodeConstraints>

<NodeGroup name="load_nodes">
  17 37 57 77;
</NodeGroup>

<ExternalForces>
  # Applied displacement (force-controlled via arc-length)
  u[17] = 0.5;
  u[37] = 0.5;
  u[57] = 0.5;
  u[77] = 0.5;
</ExternalForces>
